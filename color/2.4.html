<script>var i,J,a="button",b=`<${a} type='${a}' id='`,c=`'></${a}>`,D="<p id='",d="style",E="'></p>",e=":20px;",f="<br>",F=[],g="----",h=[37,39,40,38,90,88],H="background",r=s=>document.getElementById(s),L=[0,4,8,12,14,16,18,4,4,4,2,2,2,1],k=0,K=1,n=["#9400D3","orange","blue","#32cd32","red","#87CEFA","yellow","#bd89d3","#e2c389","#8989e2","#9bd19b","#e28989","#b8d1e1","#e2e289","#d3d3d3"],O="32323232",o=`0000111122223344556${O}${O}142`,s=[1,5,0,1,5,0,1,5,0],T=[],x=0,t="0125045714561458012401582456047801260147045615781245045801561457047901230145",u=[],R=2,U=0,W="",X="New Game",m=()=>{for(i=0;i<20;i++)for(j=0;j<19;j++)u.push(j);u.sort(()=>.5-Math.random()),s[2]=u[0],s[5]=u[1],s[8]=u[40],F=[]},G=(s,i)=>{r(s).style[H]=n[i]},M=s=>{document.write(s)},I=(s,i)=>{r(s).innerHTML=i},w=(s,i,e,o)=>10*s-10+i-T[4*e+o],C=(s,i,e)=>{G(0===e?s:"a"+s,i)},S=(s,e,r,d)=>{for(i=0;i<4;i++){let t=w(s,e,r,i);d<2?C(t,1*o[r]+7*d,0):2==d?C(t,14,0):C(t,3==d?o[r]:14,1)}},y=(s,i,e)=>F.includes(w(s,i,e,0))||F.includes(w(s,i,e,1))||F.includes(w(s,i,e,2))||F.includes(w(s,i,e,3));for(i=0;i<t.length;i++)T[i]=[0,1,2,3,10,11,12,20,21,30][t[i]];for(M(`<body onkeydown='P(event)'><${d}>${a}{border:0px;${H}:${n[14]};width${e}height${e}} #e{font-size:45px;}</${d}><table><td>`),i=0;i<20;i++){for(j=0;j<10;j++)M(b+k+c),k++;M(f)}for(k=-1,i=0;i<4;i++)for(j=0;j<10;j++)M(D+k+E),k--;for(k=0,M(`</td><td><p id='e'>TETRIS!</p>By Gem Games (2020)<br>${b}z' style='width:50%;'onclick='b()'>${X}</${a}>${f}Next${g}${g}${g} Hold${f}`),i=0;i<4;i++){for(j=0;j<10;j++)M(b+"a"+k+c),k++;M("<br>")}M("</td></table></body>"),g=!1;b=(()=>{if(g){for(g=!1,i=0;i<200;i++)G(i,14);for(i=0;i<40;i++)G(`a${i}`,14);I("z",X)}else g=!0,m(),I("z","Start Over")});var P=(e,d)=>{if(g){var t=s=>d?2==s:e.keyCode==h[s],f=(i,e,r)=>{S(5!=o[s[i]]?3:4,5!=o[s[i]]?3+r:2+r,L[o[s[i]]],e)},n=()=>{for(f(5,4,0),K=1,s[0]--,S(s[0],s[1],s[2],0),i=0;i<4;i++)F.push(w(s[0],s[1],s[2],i));for(s[0]=s[3],s[1]=s[4],s[2]=s[5],s[5]=u[R],R=R+1==u.length?0:R+1,f(5,3,0),j=0;j<20;j++){for(i=0;i<10&&0!=F.includes(10*j+i);i++);if(10==i)for(i=j;i>0;i--)for(U=0;U<10;U++)r(W=10*i+U).style[H]=r(W-10).style[H],F[F.indexOf(W)]=W+10}},l=()=>{for(i=s[0];i<21&&!y(i,s[1],s[2]);i++)x=i};y(1,6,17)&&I("e","Game Over!"),S(s[0],s[1],s[2],2),S(x,s[1],s[2],2),t(0)&&s[1]--,t(1)&&s[1]++,t(2)&&s[0]++,t(4)&&!y(s[0],s[1],s[2]+1)&&(s[2]++,s[2]==L[1*o[s[2]]]&&(s[2]=L[1*o[s[2]]-1])),t(5)&&K&&(K=0,f(8,4,5),s[0]=1,s[1]=5,J=s[2],s[2]=s[8],s[8]=J),10!=s[1]&&s[1]!=o[s[2]+19]-2||((t(0)||t(4))&&s[1]++,t(1)&&s[1]--),y(s[0],s[1],s[2])&&(t(0)&&s[1]++,t(1)&&s[1]--,t(2)&&n()),21==s[0]&&t(2)&&n(),l(),S(i-1,s[1],s[2],1),t(3)&&(s[0]=x+1,n(),l()),S(s[0],s[1],s[2],0),f(5,3,0),f(8,3,5)}},v=()=>{g&&P(null,1)},Z=setInterval(v,700);</script>
